<?xml version="1.0" encoding="utf-8"?>
<mas:CustomPanel xmlns:mx="http://www.adobe.com/2006/mxml"
    xmlns:mas="com.mindalliance.ui.*"
	width="100%" title="Conversations" status="3 messages 1 new"
	creationComplete="setupAutoShrink()"
    resizeEffect="Resize">

    <mx:Script>
        <![CDATA[
            import mx.events.ResizeEvent;
            private var panelHeight:int ;
            private function setupAutoShrink():void {
                panelHeight = this.height ;
                this.addEventListener(MouseEvent.MOUSE_OVER, panelRestore);
                this.addEventListener(MouseEvent.MOUSE_OUT, panelShrink) ;
                this.addEventListener(ResizeEvent.RESIZE, panelHeightUpdate);
                panelShrink(null);
            }
            
            private function panelHeightUpdate(event:ResizeEvent):void {
                if (!cbAutoHide.selected)
                    panelHeight = this.height ;
            }
            
            private function panelRestore(event:MouseEvent):void {
                if (cbAutoHide.selected)
                    this.height = panelHeight ;
            }
            
            private function panelShrink(event:MouseEvent):void {
                if (this.contentMouseX >= 0 && this.contentMouseX <= this.width && 
                    this.contentMouseY >=0 && this.contentMouseY <= this.height)
                    return;
                if (cbAutoHide.selected)
                    this.height = MIN_HEIGHT ;
            }
            
        ]]>
    </mx:Script>

	<mx:ArrayCollection id="dpConversations">
    	<mx:Object Priority="Low" When="Today 10:03 AM" Subject="Investigation task" Participants="Paul Diamonds, Lucy Brown, Shawn Grey" Status="1 Reply 3 Comments"/>
    	<mx:Object Priority="High" When="Today 8:12 AM" Subject="Issue Detected" Participants="System" Status="Open"/>
    	<mx:Object Priority="High" When="Yesterday 09:45 PM" Subject="Public health officer needs autopsy report" Participants="Agency Y" Status="Open"/>
    	<mx:Object Priority="Low" When="Yesterday 4:11 PM" Subject="Agency X description" Participants="Jane Doe" Status="Accepted"/>
    </mx:ArrayCollection>
    
    <mx:DataGrid dataProvider="{dpConversations}"
		horizontalScrollPolicy="off" verticalScrollPolicy="auto"
		rowCount="4"
		width="100%" height="100%">
	</mx:DataGrid>
	
	<mx:ControlBar>
	    <mx:CheckBox id="cbAutoHide" label="Auto Hide" selected="true"/>
	    <mx:Spacer width="100%"/>
		<mx:CheckBox label="Incoming" selected="true"/>
		<mx:CheckBox label="Outgoing" selected="true"/>
	</mx:ControlBar>
	
</mas:CustomPanel>
